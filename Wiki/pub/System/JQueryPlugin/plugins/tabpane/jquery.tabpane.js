"use strict";var bottomBarHeight=-1;!function(t){function a(a,i){var n=this;n.elem=t(a),n.opts=t.extend({},e,n.elem.data(),i),n.tabs={},n.init()}var e={select:1,animate:!1,autoMaxExpand:!1,minHeight:0};a.prototype.init=function(){var a,e,i=this;i.elem.prepend('<span class="foswikiClear"></span>'),a=t('<ul class="jqTabGroup"></ul>').prependTo(i.elem),e=1,i.elem.find("> .jqTab").each(function(){var n=t(this),o=n.find(".jqTabLabel:first").remove().html();a.append('<li><a href="#" data-id="'+this.id+'">'+o+"</a></li>"),n.data("hash","!"+this.id),(e===i.opts.select||t(this).hasClass(i.opts.select))&&i.switchTab(n),e++}),i.opts.autoMaxExpand&&i.autoMaxExpand(),i.elem.find(".jqTabGroup > li > a").click(function(){var a=t(this);return a.blur(),a.data("id")!==i.currentTabId&&i.switchTab("#"+a.data("id")),!1}),i.initCurrentTab(),t(window).bind("hashchange",function(){i.initCurrentTab()})},a.prototype.initCurrentTab=function(){var a=this,e=window.location.hash.replace(/^.*#/,"");void 0!==typeof a.prevHash&&a.prevHash===e||(a.prevHash=e,a.elem.find("> .jqTab").filter(function(i){var n=t(this);return""===e?a.opts.select==i+1||n.hasClass(a.opts.select):"!"+n.attr("id")===e}).each(function(){a.switchTab(t(this))}))},a.prototype.getNextTab=function(a){var e=this.elem.find("> .jqTab"),i=0;if(1!==e.length)return a=a||"#"+this.currentTabId,e.each(function(e){if(t(this).is(a))return i=e,!1}),++i>=e.length&&(i=0),e.eq(i)},a.prototype.hideTab=function(t){var a;t=t||"#"+this.currentTabId,a=this.getNextTab(t),this.elem.find(t).hide(),this.getNaviOfTab(t).hide(),this.switchTab(a)},a.prototype.showTab=function(t){var a;t=t||"#"+this.currentTabId,(a=this.elem.find(t)).length&&(this.getNaviOfTab(t).show(),this.currentTabId===a.attr("id")&&a.show())},a.prototype.getNaviOfTab=function(a){var e,i,n=t();return"object"==typeof a?e=a.attr("id"):(i=a||"#"+this.currentTabId,e=this.elem.find(i).attr("id")),this.elem.find("li a").each(function(){var a=t(this);if(a.data("id")===e)return n=a,!1}),n},a.prototype.switchTab=function(a){function e(){var a,e="none";p>0&&(e="easeInOutQuad"),d.opts.autoMaxExpand?d.opts.animate&&"none"!==e&&s.css({opacity:0}).animate({opacity:1},300):d.opts.animate&&"none"!==e&&(o.height("auto"),a=o.height(),h?(o.height(p).animate({height:a},300,e,function(){o.height("auto")}),s.css({opacity:0}).animate({opacity:1},300,e)):o.height(p).css({opacity:0}).animate({opacity:1,height:a},300,e,function(){o.height("auto")})),t(window).trigger("resize"),void 0!==r.afterHandler&&window[r.afterHandler].call(d,c,i),d.currentTabId=i}var i,n,o,r,s,h,d=this,c=d.currentTabId,u=t("#"+c),p=u.find(".jqTabContents:first").height();(n="string"==typeof a?d.elem.find(a):a)&&n.length&&(i=n.attr("id")),u.removeClass("current"),d.getNaviOfTab(u).parent().removeClass("current"),n&&(n.addClass("current"),d.getNaviOfTab(n).parent().addClass("current")),n&&c!==i&&(d.tabs[i]||(d.tabs[i]=n.data()),void 0!==(r=d.tabs[i]).beforeHandler&&window[r.beforeHandler].call(d,c,i),o=n.find(".jqTabContents:first"),(d.opts.animate||d.opts.autoMaxExpand)&&p>0&&!o.is(".jqTabDisableMaxExpand")&&o.height(p),s=o,h=!1,void 0!==r.container&&((s=o.find(r.container)).length?h=!0:s=o),void 0!==r.url?(s.load(r.url,void 0,function(){void 0!==r.afterLoadHandler&&window[r.afterLoadHandler].call(d,c,i),e()}),delete d.tabs[i].url):e())},a.prototype.autoMaxExpand=function(){var a=this;window.setTimeout(function(){a.fixHeight(),t(window).one("resize.tabpane",function(){a.autoMaxExpand()})},100)},a.prototype.fixHeight=function(){var a,e=this.elem.find("> .jqTab.current .jqTabContents:first"),i=t(window).height()||window.innerHeight;e.is(".jqTabDisableMaxExpand")||(bottomBarHeight<=0&&(bottomBarHeight=t(".natEditBottomBar").outerHeight(!0)+e.outerHeight(!0)-e.height()),a=i-e.offset().top-bottomBarHeight-2,this.opts&&this.opts.minHeight&&a<this.opts.minHeight&&(a=this.opts.minHeight),a<0||e.height(a))},t.fn.tabpane=function(e){return this.each(function(){t.data(this,"tabPane")||t.data(this,"tabPane",new a(this,e))})},t(function(){t(".jqTabPane:not(.jqInitedTabpane)").livequery(function(){t(this).addClass("jqInitedTabpane").tabpane()})})}(jQuery);
