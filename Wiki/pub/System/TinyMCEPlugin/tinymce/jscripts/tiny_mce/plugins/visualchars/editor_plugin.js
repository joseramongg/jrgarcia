tinymce.create("tinymce.plugins.VisualChars",{init:function(e,t){var a=this;a.editor=e,e.addCommand("mceVisualChars",a._toggleVisualChars,a),e.addButton("visualchars",{title:"visualchars.desc",cmd:"mceVisualChars"}),e.onBeforeGetContent.add(function(e,t){a.state&&"raw"!=t.format&&!t.draft&&(a.state=!0,a._toggleVisualChars(!1))})},getInfo:function(){return{longname:"Visual characters",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/visualchars",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_toggleVisualChars:function(e){var t,a,o,s,i,n=this.editor,r=(n.getDoc(),n.getBody()),c=n.selection;if(this.state=!this.state,n.controlManager.setActive("visualchars",this.state),e&&(i=c.getBookmark()),this.state)for(t=[],tinymce.walk(r,function(e){3==e.nodeType&&e.nodeValue&&-1!=e.nodeValue.indexOf("Â ")&&t.push(e)},"childNodes"),a=0;a<t.length;a++){for(o=(o=t[a].nodeValue).replace(/(\u00a0)/g,'<span data-mce-bogus="1" class="mceItemHidden mceItemNbsp">$1</span>'),s=n.dom.create("div",null,o);node=s.lastChild;)n.dom.insertAfter(node,t[a]);n.dom.remove(t[a])}else for(a=(t=n.dom.select("span.mceItemNbsp",r)).length-1;a>=0;a--)n.dom.remove(t[a],1);c.moveToBookmark(i)}}),tinymce.PluginManager.add("visualchars",tinymce.plugins.VisualChars);
