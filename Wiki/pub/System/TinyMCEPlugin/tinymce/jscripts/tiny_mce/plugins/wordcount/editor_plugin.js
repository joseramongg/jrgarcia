tinymce.create("tinymce.plugins.WordCount",{block:0,id:null,countre:null,cleanre:null,init:function(t,n){function e(t){return t===i.DELETE||t===i.BACKSPACE}var o=this,r=0,i=tinymce.VK;o.countre=t.getParam("wordcount_countregex",/[\w\u2019\u00co-\u00ff^\uc397^u00f7\'-]+/g),o.cleanre=t.getParam("wordcount_cleanregex",/[0-9.(),;:!?%#$?\'\"_+=\\\/-]*/g),o.update_rate=t.getParam("wordcount_update_rate",2e3),o.update_on_delete=t.getParam("wordcount_update_on_delete",!1),o.id=t.id+"-word-count",t.onPostRender.add(function(t,n){var e,r;(r=t.getParam("wordcount_target_id"))?tinymce.DOM.add(r,"span",{},'<span id="'+o.id+'">0</span>'):(e=tinymce.DOM.get(t.id+"_path_row"))&&tinymce.DOM.add(e.parentNode,"div",{style:"float: right"},t.getLang("wordcount.words","Words: ")+'<span id="'+o.id+'">0</span>')}),t.onInit.add(function(t){t.selection.onSetContent.add(function(){o._count(t)}),o._count(t)}),t.onSetContent.add(function(t){o._count(t)}),t.onKeyUp.add(function(t,n){((function(t){return t!==r&&(t===i.ENTER||r===i.SPACEBAR||e(r))})(n.keyCode)||o.update_on_delete&&e(n.keyCode))&&o._count(t),r=n.keyCode})},_getCount:function(t){var n=0,e=t.getContent({format:"raw"});if(e){var o=(e=(e=(e=(e=e.replace(/\.\.\./g," ")).replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ")).replace(/(\w+)(&.+?;)+(\w+)/,"$1$3").replace(/&.+?;/g," ")).replace(this.cleanre,"")).match(this.countre);o&&(n=o.length)}return n},_count:function(t){var n=this;n.block||(n.block=1,setTimeout(function(){if(!t.destroyed){var e=n._getCount(t);tinymce.DOM.setHTML(n.id,e.toString()),setTimeout(function(){n.block=0},n.update_rate)}},1))},getInfo:function(){return{longname:"Word Count plugin",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/wordcount",version:tinymce.majorVersion+"."+tinymce.minorVersion}}}),tinymce.PluginManager.add("wordcount",tinymce.plugins.WordCount);
