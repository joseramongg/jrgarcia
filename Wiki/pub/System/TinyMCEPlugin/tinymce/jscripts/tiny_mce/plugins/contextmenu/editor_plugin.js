!function(){var e=tinymce.dom.Event,t=(tinymce.each,tinymce.DOM);tinymce.create("tinymce.plugins.ContextMenu",{init:function(t){function n(t,n){c=0,n&&2==n.button?c=n.ctrlKey:a._menu&&(a._menu.removeAll(),a._menu.destroy(),e.remove(t.getDoc(),"click",d),a._menu=null)}var i,o,c,d,a=this;a.editor=t,o=t.settings.contextmenu_never_use_native,a.onContextMenu=new tinymce.util.Dispatcher(this),d=function(e){n(t,e)},i=t.onContextMenu.add(function(t,n){(0!==c?c:n.ctrlKey)&&!o||(e.cancel(n),"IMG"==n.target.nodeName&&t.selection.select(n.target),a._getMenu(t).showMenu(n.clientX||n.pageX,n.clientY||n.pageY),e.add(t.getDoc(),"click",d),t.nodeChanged())}),t.onRemove.add(function(){a._menu&&a._menu.removeAll()}),t.onMouseDown.add(n),t.onKeyDown.add(n),t.onKeyDown.add(function(t,n){!n.shiftKey||n.ctrlKey||n.altKey||121!==n.keyCode||(e.cancel(n),i(t,n))})},getInfo:function(){return{longname:"Contextmenu",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/contextmenu",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_getMenu:function(e){var n,i,o=this._menu,c=e.selection,d=c.isCollapsed(),a=c.getNode()||e.getBody();return o&&(o.removeAll(),o.destroy()),i=t.getPos(e.getContentAreaContainer()),o=e.controlManager.createDropMenu("contextmenu",{offset_x:i.x+e.getParam("contextmenu_offset_x",0),offset_y:i.y+e.getParam("contextmenu_offset_y",0),constrain:1,keyboard_focus:!0}),this._menu=o,o.add({title:"advanced.cut_desc",icon:"cut",cmd:"Cut"}).setDisabled(d),o.add({title:"advanced.copy_desc",icon:"copy",cmd:"Copy"}).setDisabled(d),o.add({title:"advanced.paste_desc",icon:"paste",cmd:"Paste"}),("A"!=a.nodeName||e.dom.getAttrib(a,"name"))&&d||(o.addSeparator(),o.add({title:"advanced.link_desc",icon:"link",cmd:e.plugins.advlink?"mceAdvLink":"mceLink",ui:!0}),o.add({title:"advanced.unlink_desc",icon:"unlink",cmd:"UnLink"})),o.addSeparator(),o.add({title:"advanced.image_desc",icon:"image",cmd:e.plugins.advimage?"mceAdvImage":"mceImage",ui:!0}),o.addSeparator(),(n=o.addMenu({title:"contextmenu.align"})).add({title:"contextmenu.left",icon:"justifyleft",cmd:"JustifyLeft"}),n.add({title:"contextmenu.center",icon:"justifycenter",cmd:"JustifyCenter"}),n.add({title:"contextmenu.right",icon:"justifyright",cmd:"JustifyRight"}),n.add({title:"contextmenu.full",icon:"justifyfull",cmd:"JustifyFull"}),this.onContextMenu.dispatch(this,o,a,d),o}}),tinymce.PluginManager.add("contextmenu",tinymce.plugins.ContextMenu)}();
