!function(e){function t(e,t){function a(e){return e.replace(/%(\w+)/g,"")}var o,n,s,i=e.dom,d="";return previewStyles=e.settings.preview_styles,!1===previewStyles?"":(previewStyles||(previewStyles="font-family font-size font-weight text-decoration text-transform color background-color"),o=t.block||t.inline||"span",n=i.create(o),r(t.styles,function(e,t){(e=a(e))&&i.setStyle(n,t,e)}),r(t.attributes,function(e,t){(e=a(e))&&i.setAttrib(n,t,e)}),r(t.classes,function(e){e=a(e),i.hasClass(n,e)||i.addClass(n,e)}),i.setStyles(n,{position:"absolute",left:-65535}),e.getBody().appendChild(n),s=i.getStyle(e.getBody(),"fontSize",!0),s=/px$/.test(s)?parseInt(s,10):0,r(previewStyles.split(" "),function(t){var a=i.getStyle(n,t,!0);if("background-color"!=t||!/transparent|rgba\s*\([^)]+,\s*0\)/.test(a)||(a=i.getStyle(e.getBody(),t,!0),"#ffffff"!=i.toHex(a).toLowerCase())){if("font-size"==t&&/em|%$/.test(a)){if(0===s)return;a=(a=parseFloat(a,10)/(/%$/.test(a)?100:1))*s+"px"}d+=t+":"+a+";"}}),i.remove(n),d)}var a,o=e.DOM,n=e.dom.Event,s=e.extend,r=e.each,i=e.util.Cookie,d=e.explode;e.ThemeManager.requireLangPack("advanced"),e.create("tinymce.themes.AdvancedTheme",{sizes:[8,10,12,14,18,24,36],controls:{bold:["bold_desc","Bold"],italic:["italic_desc","Italic"],underline:["underline_desc","Underline"],strikethrough:["striketrough_desc","Strikethrough"],justifyleft:["justifyleft_desc","JustifyLeft"],justifycenter:["justifycenter_desc","JustifyCenter"],justifyright:["justifyright_desc","JustifyRight"],justifyfull:["justifyfull_desc","JustifyFull"],bullist:["bullist_desc","InsertUnorderedList"],numlist:["numlist_desc","InsertOrderedList"],outdent:["outdent_desc","Outdent"],indent:["indent_desc","Indent"],cut:["cut_desc","Cut"],copy:["copy_desc","Copy"],paste:["paste_desc","Paste"],undo:["undo_desc","Undo"],redo:["redo_desc","Redo"],link:["link_desc","mceLink"],unlink:["unlink_desc","unlink"],image:["image_desc","mceImage"],cleanup:["cleanup_desc","mceCleanup"],help:["help_desc","mceHelp"],code:["code_desc","mceCodeEditor"],hr:["hr_desc","InsertHorizontalRule"],removeformat:["removeformat_desc","RemoveFormat"],sub:["sub_desc","subscript"],sup:["sup_desc","superscript"],forecolor:["forecolor_desc","ForeColor"],forecolorpicker:["forecolor_desc","mceForeColor"],backcolor:["backcolor_desc","HiliteColor"],backcolorpicker:["backcolor_desc","mceBackColor"],charmap:["charmap_desc","mceCharMap"],visualaid:["visualaid_desc","mceToggleVisualAid"],anchor:["anchor_desc","mceInsertAnchor"],newdocument:["newdocument_desc","mceNewDocument"],blockquote:["blockquote_desc","mceBlockQuote"]},stateControls:["bold","italic","underline","strikethrough","bullist","numlist","justifyleft","justifycenter","justifyright","justifyfull","sub","sup","blockquote"],init:function(t,a){var n,i,d,c=this;c.editor=t,c.url=a,c.onResolveName=new e.util.Dispatcher(this),n=t.settings,t.forcedHighContrastMode=t.settings.detect_highcontrast&&c._isHighContrast(),t.settings.skin=t.forcedHighContrastMode?"highcontrast":t.settings.skin,n.theme_advanced_buttons1||(n=s({theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect",theme_advanced_buttons2:"bullist,numlist,|,outdent,indent,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code",theme_advanced_buttons3:"hr,removeformat,visualaid,|,sub,sup,|,charmap"},n)),c.settings=n=s({theme_advanced_path:!0,theme_advanced_toolbar_location:"top",theme_advanced_blockformats:"p,address,pre,h1,h2,h3,h4,h5,h6",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_fonts:"Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats",theme_advanced_more_colors:1,theme_advanced_row_height:23,theme_advanced_resize_horizontal:1,theme_advanced_resizing_use_cookie:1,theme_advanced_font_sizes:"1,2,3,4,5,6,7",theme_advanced_font_selector:"span",theme_advanced_show_current_color:0,readonly:t.settings.readonly},n),n.font_size_style_values||(n.font_size_style_values="8pt,10pt,12pt,14pt,18pt,24pt,36pt"),e.is(n.theme_advanced_font_sizes,"string")&&(n.font_size_style_values=e.explode(n.font_size_style_values),n.font_size_classes=e.explode(n.font_size_classes||""),d={},t.settings.theme_advanced_font_sizes=n.theme_advanced_font_sizes,r(t.getParam("theme_advanced_font_sizes","","hash"),function(e,t){var a;t==e&&e>=1&&e<=7&&(t=e+" ("+c.sizes[e-1]+"pt)",a=n.font_size_classes[e-1],e=n.font_size_style_values[e-1]||c.sizes[e-1]+"pt"),/^\s*\./.test(e)&&(a=e.replace(/\./g,"")),d[t]=a?{class:a}:{fontSize:e}}),n.theme_advanced_font_sizes=d),(i=n.theme_advanced_path_location)&&"none"!=i&&(n.theme_advanced_statusbar_location=n.theme_advanced_path_location),"none"==n.theme_advanced_statusbar_location&&(n.theme_advanced_statusbar_location=0),!1!==t.settings.content_css&&t.contentCSS.push(t.baseURI.toAbsolute(a+"/skins/"+t.settings.skin+"/content.css")),t.onInit.add(function(){t.settings.readonly||(t.onNodeChange.add(c._nodeChanged,c),t.onKeyUp.add(c._updateUndoStatus,c),t.onMouseUp.add(c._updateUndoStatus,c),t.dom.bind(t.dom.getRoot(),"dragend",function(){c._updateUndoStatus(t)}))}),t.onSetProgressState.add(function(e,t,a){var n,s,r=e.id;t?c.progressTimer=setTimeout(function(){n=(n=e.getContainer()).insertBefore(o.create("DIV",{style:"position:relative"}),n.firstChild),s=o.get(e.id+"_tbl"),o.add(n,"div",{id:r+"_blocker",class:"mceBlocker",style:{width:s.clientWidth+2,height:s.clientHeight+2}}),o.add(n,"div",{id:r+"_progress",class:"mceProgress",style:{left:s.clientWidth/2,top:s.clientHeight/2}})},a||0):(o.remove(r+"_blocker"),o.remove(r+"_progress"),clearTimeout(c.progressTimer))}),o.loadCSS(n.editor_css?t.documentBaseURI.toAbsolute(n.editor_css):a+"/skins/"+t.settings.skin+"/ui.css"),n.skin_variant&&o.loadCSS(a+"/skins/"+t.settings.skin+"/ui_"+n.skin_variant+".css")},_isHighContrast:function(){var e,t=o.add(o.getRoot(),"div",{style:"background-color: rgb(171,239,86);"});return e=(o.getStyle(t,"background-color",!0)+"").toLowerCase().replace(/ /g,""),o.remove(t),"rgb(171,239,86)"!=e&&"#abef56"!=e},createControl:function(e,t){var a,o;if(o=t.createControl(e))return o;switch(e){case"styleselect":return this._createStyleSelect();case"formatselect":return this._createBlockFormats();case"fontselect":return this._createFontSelect();case"fontsizeselect":return this._createFontSizeSelect();case"forecolor":return this._createForeColorMenu();case"backcolor":return this._createBackColorMenu()}return(a=this.controls[e])?t.createButton(e,{title:"advanced."+a[0],cmd:a[1],ui:a[2],value:a[3]}):void 0},execCommand:function(e,t,a){var o=this["_"+e];return!!o&&(o.call(this,t,a),!0)},_importClasses:function(e){var a=this.editor,o=a.controlManager.get("styleselect");0==o.getLength()&&r(a.dom.getClasses(),function(e,n){var s,r="style_"+n;s={inline:"span",attributes:{class:e.class},selector:"*"},a.formatter.register(r,s),o.add(e.class,r,{style:function(){return t(a,s)}})})},_createStyleSelect:function(a){var o,s=this,i=s.editor,d=i.controlManager;return o=d.createListBox("styleselect",{title:"advanced.style_select",onselect:function(t){var a,n,s=[];return r(o.items,function(e){s.push(e.value)}),i.focus(),i.undoManager.add(),a=i.formatter.matchAll(s),e.each(a,function(e){t&&e!=t||(e&&i.formatter.remove(e),n=!0)}),n||i.formatter.apply(t),i.undoManager.add(),i.nodeChanged(),!1}}),i.onPreInit.add(function(){var e=0,a=i.getParam("style_formats");a?r(a,function(a){var n,s=0;r(a,function(){s++}),s>1?(n=a.name=a.name||"style_"+e++,i.formatter.register(n,a),o.add(a.title,n,{style:function(){return t(i,a)}})):o.add(a.title)}):r(i.getParam("theme_advanced_styles","","hash"),function(a,n){var r,d;a&&(r="style_"+e++,d={inline:"span",classes:a,selector:"*"},i.formatter.register(r,d),o.add(s.editor.translate(n),r,{style:function(){return t(i,d)}}))})}),0==o.getLength()&&o.onPostRender.add(function(e,t){o.NativeListBox?n.add(t.id,"focus",s._importClasses,s):(n.add(t.id+"_text","focus",s._importClasses,s),n.add(t.id+"_text","mousedown",s._importClasses,s),n.add(t.id+"_open","focus",s._importClasses,s),n.add(t.id+"_open","mousedown",s._importClasses,s))}),o},_createFontSelect:function(){var e,t=this.editor;return(e=t.controlManager.createListBox("fontselect",{title:"advanced.fontdefault",onselect:function(a){var o=e.items[e.selectedIndex];{if(a||!o)return t.execCommand("FontName",!1,a),e.select(function(e){return a==e}),o&&o.value==a&&e.select(null),!1;t.execCommand("FontName",!1,o.value)}}}))&&r(t.getParam("theme_advanced_fonts",this.settings.theme_advanced_fonts,"hash"),function(a,o){e.add(t.translate(o),a,{style:-1==a.indexOf("dings")?"font-family:"+a:""})}),e},_createFontSizeSelect:function(){var e,t=this,a=t.editor,o=0;return(e=a.controlManager.createListBox("fontsizeselect",{title:"advanced.font_size",onselect:function(t){var o=e.items[e.selectedIndex];{if(t||!o)return t.class?(a.focus(),a.undoManager.add(),a.formatter.toggle("fontsize_class",{value:t.class}),a.undoManager.add(),a.nodeChanged()):a.execCommand("FontSize",!1,t.fontSize),e.select(function(e){return t==e}),o&&(o.value.fontSize==t.fontSize||o.value.class&&o.value.class==t.class)&&e.select(null),!1;(o=o.value).class?(a.formatter.toggle("fontsize_class",{value:o.class}),a.undoManager.add(),a.nodeChanged()):a.execCommand("FontSize",!1,o.fontSize)}}}))&&r(t.settings.theme_advanced_font_sizes,function(a,n){var s=a.fontSize;s>=1&&s<=7&&(s=t.sizes[parseInt(s)-1]+"pt"),e.add(n,a,{style:"font-size:"+s,class:"mceFontSize"+o+++" "+(a.class||"")})}),e},_createBlockFormats:function(){var e,a={p:"advanced.paragraph",address:"advanced.address",pre:"advanced.pre",h1:"advanced.h1",h2:"advanced.h2",h3:"advanced.h3",h4:"advanced.h4",h5:"advanced.h5",h6:"advanced.h6",div:"advanced.div",blockquote:"advanced.blockquote",code:"advanced.code",dt:"advanced.dt",dd:"advanced.dd",samp:"advanced.samp"},o=this;return(e=o.editor.controlManager.createListBox("formatselect",{title:"advanced.block",onselect:function(e){return o.editor.execCommand("FormatBlock",!1,e),!1}}))&&r(o.editor.getParam("theme_advanced_blockformats",o.settings.theme_advanced_blockformats,"hash"),function(n,s){e.add(o.editor.translate(s!=n?s:a[n]),n,{class:"mce_formatPreview mce_"+n,style:function(){return t(o.editor,{block:n})}})}),e},_createForeColorMenu:function(){var e,t,a=this,o=a.settings,n={};return o.theme_advanced_more_colors&&(n.more_colors_func=function(){a._mceColorPicker(0,{color:e.value,func:function(t){e.setColor(t)}})}),(t=o.theme_advanced_text_colors)&&(n.colors=t),o.theme_advanced_default_foreground_color&&(n.default_color=o.theme_advanced_default_foreground_color),n.title="advanced.forecolor_desc",n.cmd="ForeColor",n.scope=this,e=a.editor.controlManager.createColorSplitButton("forecolor",n)},_createBackColorMenu:function(){var e,t,a=this,o=a.settings,n={};return o.theme_advanced_more_colors&&(n.more_colors_func=function(){a._mceColorPicker(0,{color:e.value,func:function(t){e.setColor(t)}})}),(t=o.theme_advanced_background_colors)&&(n.colors=t),o.theme_advanced_default_background_color&&(n.default_color=o.theme_advanced_default_background_color),n.title="advanced.backcolor_desc",n.cmd="HiliteColor",n.scope=this,e=a.editor.controlManager.createColorSplitButton("backcolor",n)},renderUI:function(t){var a,s,i,d,c,l,_=this,u=_.editor,h=_.settings;switch(u.settings&&(u.settings.aria_label=h.aria_label+u.getLang("advanced.help_shortcut")),a=c=o.create("span",{role:"application","aria-labelledby":u.id+"_voice",id:u.id+"_parent",class:"mceEditor "+u.settings.skin+"Skin"+(h.skin_variant?" "+u.settings.skin+"Skin"+_._ufirst(h.skin_variant):"")+("rtl"==u.settings.directionality?" mceRtl":"")}),o.add(a,"span",{class:"mceVoiceLabel",style:"display:none;",id:u.id+"_voice"},h.aria_label),o.boxModel||(a=o.add(a,"div",{class:"mceOldBoxModel"})),a=d=o.add(a,"table",{role:"presentation",id:u.id+"_tbl",class:"mceLayout",cellSpacing:0,cellPadding:0}),a=i=o.add(a,"tbody"),(h.theme_advanced_layout_manager||"").toLowerCase()){case"rowlayout":s=_._rowLayout(h,i,t);break;case"customlayout":s=u.execCallback("theme_advanced_custom_layout",h,i,t,c);break;default:s=_._simpleLayout(h,i,t,c)}return a=t.targetNode,l=d.rows,o.addClass(l[0],"mceFirst"),o.addClass(l[l.length-1],"mceLast"),r(o.select("tr",i),function(e){o.addClass(e.firstChild,"mceFirst"),o.addClass(e.childNodes[e.childNodes.length-1],"mceLast")}),o.get(h.theme_advanced_toolbar_container)?o.get(h.theme_advanced_toolbar_container).appendChild(c):o.insertAfter(c,a),n.add(u.id+"_path_row","click",function(e){if("A"==(e=e.target).nodeName)return _._sel(e.className.replace(/^.*mcePath_([0-9]+).*$/,"$1")),!1}),u.getParam("accessibility_focus")||n.add(o.add(c,"a",{href:"#"},"\x3c!-- IE --\x3e"),"focus",function(){tinyMCE.get(u.id).focus()}),"external"==h.theme_advanced_toolbar_location&&(t.deltaHeight=0),_.deltaHeight=t.deltaHeight,t.targetNode=null,u.onKeyDown.add(function(t,a){if(a.altKey){if(121===a.keyCode)return e.isWebKit&&window.focus(),_.toolbarGroup.focus(),n.cancel(a);if(122===a.keyCode)return o.get(t.id+"_path_row").focus(),n.cancel(a)}}),u.addShortcut("alt+0","","mceShortcuts",_),{iframeContainer:s,editorContainer:u.id+"_parent",sizeContainer:d,deltaHeight:t.deltaHeight}},getInfo:function(){return{longname:"Advanced theme",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",version:e.majorVersion+"."+e.minorVersion}},resizeBy:function(e,t){var a=o.get(this.editor.id+"_ifr");this.resizeTo(a.clientWidth+e,a.clientHeight+t)},resizeTo:function(e,t,a){var n=this.editor,s=this.settings,r=o.get(n.id+"_tbl"),d=o.get(n.id+"_ifr");e=Math.max(s.theme_advanced_resizing_min_width||100,e),t=Math.max(s.theme_advanced_resizing_min_height||100,t),e=Math.min(s.theme_advanced_resizing_max_width||65535,e),t=Math.min(s.theme_advanced_resizing_max_height||65535,t),o.setStyle(r,"height",""),o.setStyle(d,"height",t),s.theme_advanced_resize_horizontal&&(o.setStyle(r,"width",""),o.setStyle(d,"width",e),e<r.clientWidth&&(e=r.clientWidth,o.setStyle(d,"width",r.clientWidth))),a&&s.theme_advanced_resizing_use_cookie&&i.setHash("TinyMCE_"+n.id+"_size",{cw:e,ch:t})},destroy:function(){var e=this.editor.id;n.clear(e+"_resize"),n.clear(e+"_path_row"),n.clear(e+"_external_close")},_simpleLayout:function(e,t,s,r){var i,d,c,l,_=this.editor,u=e.theme_advanced_toolbar_location,h=e.theme_advanced_statusbar_location;return e.readonly?(i=o.add(t,"tr"),i=d=o.add(i,"td",{class:"mceIframeContainer"}),d):("top"==u&&this._addToolbars(t,s),"external"==u&&(i=l=o.create("div",{style:"position:relative"}),i=o.add(i,"div",{id:_.id+"_external",class:"mceExternalToolbar"}),o.add(i,"a",{id:_.id+"_external_close",href:"javascript:;",class:"mceExternalClose"}),i=o.add(i,"table",{id:_.id+"_tblext",cellSpacing:0,cellPadding:0}),c=o.add(i,"tbody"),"mceOldBoxModel"==r.firstChild.className?r.firstChild.appendChild(l):r.insertBefore(l,r.firstChild),this._addToolbars(c,s),_.onMouseUp.add(function(){var e=o.get(_.id+"_external");o.show(e),o.hide(a);var t=n.add(_.id+"_external_close","click",function(){return o.hide(_.id+"_external"),n.remove(_.id+"_external_close","click",t),!1});o.show(e),o.setStyle(e,"top",0-o.getRect(_.id+"_tblext").h-1),o.hide(e),o.show(e),e.style.filter="",a=_.id+"_external",e=null})),"top"==h&&this._addStatusBar(t,s),e.theme_advanced_toolbar_container||(i=o.add(t,"tr"),i=d=o.add(i,"td",{class:"mceIframeContainer"})),"bottom"==u&&this._addToolbars(t,s),"bottom"==h&&this._addStatusBar(t,s),d)},_rowLayout:function(e,t,a){var n,s,i,c,l,_,u=this,h=u.editor.controlManager;return n=e.theme_advanced_containers_default_class||"",s=e.theme_advanced_containers_default_align||"center",r(d(e.theme_advanced_containers||""),function(r,d){var m=e["theme_advanced_container_"+r]||"";switch(r.toLowerCase()){case"mceeditor":i=o.add(t,"tr"),i=c=o.add(i,"td",{class:"mceIframeContainer"});break;case"mceelementpath":u._addStatusBar(t,a);break;default:_=(e["theme_advanced_container_"+r+"_align"]||s).toLowerCase(),_="mce"+u._ufirst(_),i=o.add(o.add(t,"tr"),"td",{class:"mceToolbar "+(e["theme_advanced_container_"+r+"_class"]||n)+" "+_||s}),l=h.createToolbar("toolbar"+d),u._addControls(m,l),o.setHTML(i,l.renderHTML()),a.deltaHeight-=e.theme_advanced_row_height}}),c},_addControls:function(e,t){var a,o=this,n=o.settings,s=o.editor.controlManager;n.theme_advanced_disable&&!o._disabled?(a={},r(d(n.theme_advanced_disable),function(e){a[e]=1}),o._disabled=a):a=o._disabled,r(d(e),function(e){var n;a&&a[e]||("tablecontrols"!=e?(n=o.createControl(e,s))&&t.add(n):r(["table","|","row_props","cell_props","|","row_before","row_after","delete_row","|","col_before","col_after","delete_col","|","split_cells","merge_cells"],function(e){(e=o.createControl(e,s))&&t.add(e)}))})},_addToolbars:function(e,t){var a,n,s,r,i,d,c=this.editor,l=this.settings,_=c.controlManager,u=[],h=!1;for(d=_.createToolbarGroup("toolbargroup",{name:c.getLang("advanced.toolbar"),tab_focus_toolbar:c.getParam("theme_advanced_tab_focus_toolbar")}),this.toolbarGroup=d,i=l.theme_advanced_toolbar_align.toLowerCase(),i="mce"+this._ufirst(i),r=o.add(o.add(e,"tr",{role:"presentation"}),"td",{class:"mceToolbar "+i,role:"toolbar"}),a=1;s=l["theme_advanced_buttons"+a];a++)h=!0,n=_.createToolbar("toolbar"+a,{class:"mceToolbarRow"+a}),l["theme_advanced_buttons"+a+"_add"]&&(s+=","+l["theme_advanced_buttons"+a+"_add"]),l["theme_advanced_buttons"+a+"_add_before"]&&(s=l["theme_advanced_buttons"+a+"_add_before"]+","+s),this._addControls(s,n),d.add(n),t.deltaHeight-=l.theme_advanced_row_height;h||(t.deltaHeight-=l.theme_advanced_row_height),u.push(d.renderHTML()),u.push(o.createHTML("a",{href:"#",accesskey:"z",title:c.getLang("advanced.toolbar_focus"),onfocus:"tinyMCE.getInstanceById('"+c.id+"').focus();"},"\x3c!-- IE --\x3e")),o.setHTML(r,u.join(""))},_addStatusBar:function(e,t){var a,s,r=this,d=r.editor,c=r.settings;a=o.add(e,"tr"),a=s=o.add(a,"td",{class:"mceStatusbar"}),a=o.add(a,"div",{id:d.id+"_path_row",role:"group","aria-labelledby":d.id+"_path_voice"}),c.theme_advanced_path?(o.add(a,"span",{id:d.id+"_path_voice"},d.translate("advanced.path")),o.add(a,"span",{},": ")):o.add(a,"span",{},"&#160;"),c.theme_advanced_resizing&&(o.add(s,"a",{id:d.id+"_resize",href:"javascript:;",onclick:"return false;",class:"mceResize",tabIndex:"-1"}),c.theme_advanced_resizing_use_cookie&&d.onPostRender.add(function(){var e=i.getHash("TinyMCE_"+d.id+"_size");o.get(d.id+"_tbl");e&&r.resizeTo(e.cw,e.ch)}),d.onPostRender.add(function(){n.add(d.id+"_resize","click",function(e){e.preventDefault()}),n.add(d.id+"_resize","mousedown",function(e){function t(e){e.preventDefault(),f=h+(e.screenX-_),g=m+(e.screenY-u),r.resizeTo(f,g)}function a(e){n.remove(o.doc,"mousemove",s),n.remove(d.getDoc(),"mousemove",i),n.remove(o.doc,"mouseup",c),n.remove(d.getDoc(),"mouseup",l),f=h+(e.screenX-_),g=m+(e.screenY-u),r.resizeTo(f,g,!0),d.nodeChanged()}var s,i,c,l,_,u,h,m,f,g,v;e.preventDefault(),_=e.screenX,u=e.screenY,v=o.get(r.editor.id+"_ifr"),h=f=v.clientWidth,m=g=v.clientHeight,s=n.add(o.doc,"mousemove",t),i=n.add(d.getDoc(),"mousemove",t),c=n.add(o.doc,"mouseup",a),l=n.add(d.getDoc(),"mouseup",a)})})),t.deltaHeight-=21,a=e=null},_updateUndoStatus:function(e){var t=e.controlManager,a=e.undoManager;t.setDisabled("undo",!a.hasUndo()&&!a.typing),t.setDisabled("redo",!a.hasRedo())},_nodeChanged:function(t,a,n,s,i){function d(e){var t,a=i.parents,o=e;for("string"==typeof e&&(o=function(t){return t.nodeName==e}),t=0;t<a.length;t++)if(o(a[t]))return a[t]}function c(e,t){(u=a.get(e))&&(t||(t=u.settings.default_color),t!==u.value&&u.displayColor(t))}function c(e,t){(u=a.get(e))&&(t||(t=u.settings.default_color),t!==u.value&&u.displayColor(t))}var l,_,u,h,m,f,g,v,p,b,y=this,C=0,k=y.settings;e.each(y.stateControls,function(e){a.setActive(e,t.queryCommandState(y.controls[e][1]))}),a.setActive("visualaid",t.hasVisual),y._updateUndoStatus(t),a.setDisabled("outdent",!t.queryCommandState("Outdent")),l=d("A"),(u=a.get("link"))&&(u.setDisabled(!l&&s||l&&!l.href),u.setActive(!!l&&!l.name&&!l.id)),(u=a.get("unlink"))&&(u.setDisabled(!l&&s),u.setActive(!!l&&!l.name&&!l.id)),(u=a.get("anchor"))&&u.setActive(!s&&!!l&&(l.name||l.id&&!l.href)),l=d("IMG"),(u=a.get("image"))&&u.setActive(!s&&!!l&&-1==n.className.indexOf("mceItem")),(u=a.get("styleselect"))&&(y._importClasses(),p=[],r(u.items,function(e){p.push(e.value)}),b=t.formatter.matchAll(p),u.select(b[0]),e.each(b,function(e,t){t>0&&u.mark(e)})),(u=a.get("formatselect"))&&(l=d(t.dom.isBlock))&&u.select(l.nodeName.toLowerCase()),d(function(e){return"SPAN"===e.nodeName&&!h&&e.className&&(h=e.className),t.dom.is(e,k.theme_advanced_font_selector)&&(!m&&e.style.fontSize&&(m=e.style.fontSize),!f&&e.style.fontFamily&&(f=e.style.fontFamily.replace(/[\"\']+/g,"").replace(/^([^,]+).*/,"$1").toLowerCase()),!g&&e.style.color&&(g=e.style.color),!v&&e.style.backgroundColor&&(v=e.style.backgroundColor)),!1}),(u=a.get("fontselect"))&&u.select(function(e){return e.replace(/^([^,]+).*/,"$1").toLowerCase()==f}),(u=a.get("fontsizeselect"))&&(!k.theme_advanced_runtime_fontsize||m||h||(m=t.dom.getStyle(n,"fontSize",!0)),u.select(function(e){return!(!e.fontSize||e.fontSize!==m)||(!(!e.class||e.class!==h)||void 0)})),k.theme_advanced_show_current_color&&(c("forecolor",g),c("backcolor",v)),k.theme_advanced_show_current_color&&(c("forecolor",g),c("backcolor",v)),k.theme_advanced_path&&k.theme_advanced_statusbar_location&&(l=o.get(t.id+"_path")||o.add(t.id+"_path_row","span",{id:t.id+"_path"}),y.statusKeyboardNavigation&&(y.statusKeyboardNavigation.destroy(),y.statusKeyboardNavigation=null),o.setHTML(l,""),d(function(a){var n,s=a.nodeName.toLowerCase(),r="";if(!(1!=a.nodeType||"br"===s||a.getAttribute("data-mce-bogus")||o.hasClass(a,"mceItemHidden")||o.hasClass(a,"mceItemRemoved"))){switch(e.isIE&&"HTML"!==a.scopeName&&a.scopeName&&(s=a.scopeName+":"+s),s=s.replace(/mce\:/g,"")){case"b":s="strong";break;case"i":s="em";break;case"img":(_=o.getAttrib(a,"src"))&&(r+="src: "+_+" ");break;case"a":(_=o.getAttrib(a,"name"))&&(r+="name: "+_+" ",s+="#"+_),(_=o.getAttrib(a,"href"))&&(r+="href: "+_+" ");break;case"font":(_=o.getAttrib(a,"face"))&&(r+="font: "+_+" "),(_=o.getAttrib(a,"size"))&&(r+="size: "+_+" "),(_=o.getAttrib(a,"color"))&&(r+="color: "+_+" ");break;case"span":(_=o.getAttrib(a,"style"))&&(r+="style: "+_+" ")}(_=o.getAttrib(a,"id"))&&(r+="id: "+_+" "),(_=a.className)&&(_=_.replace(/\b\s*(webkit|mce|Apple-)\w+\s*\b/g,""))&&(r+="class: "+_+" ",(t.dom.isBlock(a)||"img"==s||"span"==s)&&(s+="."+_)),s={name:s=s.replace(/(html:)/g,""),node:a,title:r},y.onResolveName.dispatch(y,s),r=s.title,s=s.name,n=o.create("a",{href:"javascript:;",role:"button",onmousedown:"return false;",title:r,class:"mcePath_"+C++},s),l.hasChildNodes()?(l.insertBefore(o.create("span",{"aria-hidden":"true"}," » "),l.firstChild),l.insertBefore(n,l.firstChild)):l.appendChild(n)}},t.getBody()),o.select("a",l).length>0&&(y.statusKeyboardNavigation=new e.ui.KeyboardNavigation({root:t.id+"_path_row",items:o.select("a",l),excludeFromTabOrder:!0,onCancel:function(){t.focus()}},o)))},_sel:function(e){this.editor.execCommand("mceSelectNodeDepth",!1,e)},_mceInsertAnchor:function(e,t){var a=this.editor;a.windowManager.open({url:this.url+"/anchor.htm",width:320+parseInt(a.getLang("advanced.anchor_delta_width",0)),height:90+parseInt(a.getLang("advanced.anchor_delta_height",0)),inline:!0},{theme_url:this.url})},_mceCharMap:function(){var e=this.editor;e.windowManager.open({url:this.url+"/charmap.htm",width:550+parseInt(e.getLang("advanced.charmap_delta_width",0)),height:265+parseInt(e.getLang("advanced.charmap_delta_height",0)),inline:!0},{theme_url:this.url})},_mceHelp:function(){this.editor.windowManager.open({url:this.url+"/about.htm",width:480,height:380,inline:!0},{theme_url:this.url})},_mceShortcuts:function(){this.editor.windowManager.open({url:this.url+"/shortcuts.htm",width:480,height:380,inline:!0},{theme_url:this.url})},_mceColorPicker:function(e,t){var a=this.editor;t=t||{},a.windowManager.open({url:this.url+"/color_picker.htm",width:375+parseInt(a.getLang("advanced.colorpicker_delta_width",0)),height:250+parseInt(a.getLang("advanced.colorpicker_delta_height",0)),close_previous:!1,inline:!0},{input_color:t.color,func:t.func,theme_url:this.url})},_mceCodeEditor:function(e,t){var a=this.editor;a.windowManager.open({url:this.url+"/source_editor.htm",width:parseInt(a.getParam("theme_advanced_source_editor_width",720)),height:parseInt(a.getParam("theme_advanced_source_editor_height",580)),inline:!0,resizable:!0,maximizable:!0},{theme_url:this.url})},_mceImage:function(e,t){var a=this.editor;-1==a.dom.getAttrib(a.selection.getNode(),"class","").indexOf("mceItem")&&a.windowManager.open({url:this.url+"/image.htm",width:355+parseInt(a.getLang("advanced.image_delta_width",0)),height:275+parseInt(a.getLang("advanced.image_delta_height",0)),inline:!0},{theme_url:this.url})},_mceLink:function(e,t){var a=this.editor;a.windowManager.open({url:this.url+"/link.htm",width:310+parseInt(a.getLang("advanced.link_delta_width",0)),height:200+parseInt(a.getLang("advanced.link_delta_height",0)),inline:!0},{theme_url:this.url})},_mceNewDocument:function(){var e=this.editor;e.windowManager.confirm("advanced.newdocument",function(t){t&&e.execCommand("mceSetContent",!1,"")})},_mceForeColor:function(){var e=this;this._mceColorPicker(0,{color:e.fgColor,func:function(t){e.fgColor=t,e.editor.execCommand("ForeColor",!1,t)}})},_mceBackColor:function(){var e=this;this._mceColorPicker(0,{color:e.bgColor,func:function(t){e.bgColor=t,e.editor.execCommand("HiliteColor",!1,t)}})},_ufirst:function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}}),e.ThemeManager.add("advanced",e.themes.AdvancedTheme)}(tinymce);
